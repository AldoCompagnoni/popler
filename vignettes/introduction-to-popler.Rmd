---
title: "Introduction to popler"
author: "Aldo Compagnoni"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

popler allows browsing and querying population data collected at `Long Term Ecological Research (LTER) network` sites located across the United States of America. A subset of the population data from the LTER network is now contained in an online database called popler. The popler R package is an interface with this online database, allowing users to:

- explore *what type* and *how much* population data is contained in the popler database
- download data contained in the popler database


## Installation

The popler R package is currently in the development phase, and it should be downloaded directly from its [GitHub page](https://github.com/AldoCompagnoni/popler). Before doing this, make sure to install the [Devtools R package](https://cran.r-project.org/web/packages/devtools/README.html). Once devtools is installed on your machine, install and load popler:

```r
devtools::install_github("AldoCompagnoni/popler",ref = "0.0.9001",
                          build_vignettes = TRUE)
library("popler")
```

## Metadata: what type of data is contained in the popler database?

The LTER network provides data from thousands of research projects. The metadata of these projects allow understanding *what* and *how much* population data is provided by each project. The popler R package provides three functions to explore these metadata.

### dictionary()

`dictionary()` explains what variables are contained in the metadata of each project.  

```r
dictionary()
```

Specify one or more of these variables to know what their content is, across all projects:

```r
dictionary("species")
dictionary(vars = c("lterid", "duration_years") )
```

### summary_popler()

`summary_popler()` counts the number of unique records in metadata variables. The default counts the number of projects contained in popler:

```r
summary_popler()
```

`summary_popler()` also allows grouping counts. For example, it counts the number of species observed in each project:

```r
summary_popler(group_variables = "title", count_variables = "species", trim = TRUE)
```

### browse()

browse() accesses the popler metadata table directly, and allows subsetting it. Calling the function returns the entire metadata table:

```r
metadata_table <- browse()
```

This metadata table can be subset by specifying a logical statement. This is useful to focus on datasets of interest.

```r
sevilleta      <- browse(lterid == "SEV")
poa_projects   <- browse(genus == "Poa")
```

## Download the data

Once you identified one or more datasets that you are interested in, download their raw data using `get_data()`. You can obtain the data in three ways:

1. by providing an object created subsetting the metadata table using `browse()` 
1. by further subsetting an object created through `browse()`
1. by providing a logical statement to `get_data()`

First, providing an object created through `browse()`:

```r
poa_data      <- get_data(poa_projects)
```

Second, further subsetting an object created through `browse()`:

```r
poa_data_13   <- get_data(poa_projects, duration_years > 13)
```

Third, providing a logical statement directly to `get_data()`:

```r
parasite_data         <- get_data(subset = proj_metadata_key == 25)
```
